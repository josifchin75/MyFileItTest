<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, user-scalable=yes, width=device-width">
    <title></title>
    <style>
        .angular-google-map-container {
            width: 100%;
            height: 504px;
        }
    </style>
    <script src="cordova.js"></script>
    <script src="scripts/platformOverrides.js"></script>

    <!-- TestIonicTemplate references -->
    <link href="lib/ionic/css/ionic.css" rel="stylesheet" />
    <link href="css/index.css" rel="stylesheet" />
    <!--<link href="css/myfileitmobile.css" rel="stylesheet" />-->
    <!--<link href="http://code.ionicframework.com/ionicons/1.5.2/css/ionicons.min.css" rel="stylesheet">-->
    <link href="css/ionicons.min.css" rel="stylesheet" />

    <script src="lib/ionic/js/ionic.bundle.js"></script>
    <!--<script src="lib/checklist/checklist-model.js"></script>-->

    <script src="lib/moment/moment.js"></script>
    <!--<script src="lib/jquery/jquery-2.1.4.min.js"></script>-->

    <script src="lib/jquery/jquery-2.1.4.min.js"></script>

    <script src="lib/iScroll/iscroll.js"></script>
    <!--Concierge help -->
    <!--<script src='http://websdk.live.gotoassist.com/concierge.js'></script>-->
    <!-- IF using Sass (run gulp sass first), then uncomment below and remove the CSS includes above
    <link href="css/ionic.app.css" rel="stylesheet">
    -->

    <script type="text/javascript">
    var myScroll;
    function loadScroll() {
        setTimeout(function () {
            //debugger;
            //alert('scroll');
            myScroll = new iScroll('wrapper',
            { zoom: true, zoomMax: 4 });
        }, 1000);
    }

    document.addEventListener('DOMContentLoaded', loadScroll, false);

    //function initConcierge() {
        //concierge.setApplicationKey('MTQyOTs1Nzg=-1d2nf8bvvrlxqnvd0g5vfq2jkcrkk1hsjkr571bfg7hpqmhhk0wxm5i8wi4y8j1o');
   // }

    function openSupportWindow() {
        if (window.plugins && window.plugins.Hipmob) {
            var hipmob_app_id = '62f5b89ea9424be79419e8935a4354be';
            var Hipmob = window.plugins.Hipmob;

            Hipmob.openHelpdeskSearch(hipmob_app_id, {
                'title': 'Help',
                'query': 'Android',
                'user': '<hipmob user id>',
                'name': 'Femi',
                'email': 'femi@hipmob.com',
                'context': 'shopping for shoes',
                'location': 'At home'
            });
        } else {
            alert('Hipmob plugin not available/ready.');
        }
    }

   // function initInAppPurchases() {
            
    //}
    </script>
</head>
<body>

    <!--<body ng-app="app" animation="slide-left-right-ios7">-->
    <div ng-app="app">
        <!--<div class="splash">
            <img src="images/splash.png" />
        </div>-->
        <div>
            <div>
                <ion-side-menus enable-menu-with-back-views="true">

                    <!-- Center content -->
                    <ion-side-menu-content enable-menu-with-back-views="true" edge-drag-threshold="200">
                        <ion-nav-bar class="bar-light">

                        </ion-nav-bar>
                        <ion-nav-view class="main-content"></ion-nav-view>
                    </ion-side-menu-content>

                    <!-- Left menu -->
                    <ion-side-menu side="left" ng-controller="sideMenuCtrl">
                        <ng-include src="'templates/sideMenu.html'"></ng-include>
                    </ion-side-menu>

                </ion-side-menus>

                <!--
                <ion-nav-bar class="bar-stable">

                </ion-nav-bar>
                <ion-nav-view></ion-nav-view>
                -->

            </div>
        </div>

    </div>


    <script src="scripts/app.js"></script>
    <script src="scripts/controllers.js"></script>
    <script src="scripts/routes.js"></script>
    <script src="scripts/services.js"></script>
    <script src="scripts/directives.js"></script>
    <script src="scripts/fileHelper.js"></script>
    <script src="scripts/dbHelper.js"></script>

    <script type="text/javascript">
        app.initialize();
        loadScroll();
        //initConcierge();
        //initInAppPurchases();

        window.onerror = function (err) { 
            alert(err);
        };

        dbHelper.init();

        shareKeySKU = 'Myfileitsharekeyannual';
        
        IAP = {
            list: [shareKeySKU]
        };

        IAP.load = function () {
            alert('loading inapp module');
            // Check availability of the storekit plugin
            if (!window.storekit) {
                alert("In-App Purchases not available");
                return;
            }

            // Initialize
            storekit.init({
                debug: true, // Enable IAP messages on the console
                ready: IAP.onReady,
                purchase: IAP.onPurchase,
                restore: IAP.onRestore,
                error: IAP.onError
            });
            alert('before onready');
            IAP.onReady = function () {
                alert('in onReady');
                storekit.load(IAP.list, function (products, invalidIds) {
                    alert('ready');
                    alert(products);
                    IAP.products = products;
                    IAP.loaded = true;
                    for (var i = 0; i < invalidIds.length; ++i) {
                        alert("Error: could not load " + invalidIds[i]);
                    }
                });
            };

            IAP.onPurchase = function (transactionId, productId, receipt) {
                alert('onpurchase');
                if (productId === shareKeySKU) {
                    loadShareKey(transactionId, productId, receipt);
                }
            };

            IAP.onRestore = function (transactionId, productId, transactionReceipt) {
                alert('onRestore');
                if (productId == shareKeySKU) {
                    //Code to remove ads for the user
                    loadShareKey(transactionId, productId, receipt);
                }
            };

            IAP.onError = function (errorCode, errorMessage) {
                alert(errorCode);
                alert(errorMessage);
                window.onerror(errorCode + errorMessage);
            };

            IAP.buy = function (productId) {
                alert('in buy method' + productId)
                storekit.purchase(productId);
            };

            IAP.restore = function () {
                storekit.restore();
            };

           

        };

        function loadShareKey(transactionId, productId, receipt) {
            alert(transactionId);
            alert(productId);
            alert(receipt);
        }
    </script>
</body>
</html>
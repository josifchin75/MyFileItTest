<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, user-scalable=yes, width=device-width">
    <title></title>
    <style>
        .angular-google-map-container {
            width: 100%;
            height: 504px;
        }
    </style>
    <script src="cordova.js"></script>
    <script src="scripts/platformOverrides.js"></script>

    <!-- TestIonicTemplate references -->
    <link href="lib/ionic/css/ionic.css" rel="stylesheet" />
    <link href="css/index.css" rel="stylesheet" />
    <!--<link href="css/myfileitmobile.css" rel="stylesheet" />-->
    <!--<link href="http://code.ionicframework.com/ionicons/1.5.2/css/ionicons.min.css" rel="stylesheet">-->
    <link href="css/ionicons.min.css" rel="stylesheet" />

    <script src="lib/ionic/js/ionic.bundle.js"></script>
    <!--<script src="lib/checklist/checklist-model.js"></script>-->

    <script src="lib/moment/moment.js"></script>
    <!--<script src="lib/jquery/jquery-2.1.4.min.js"></script>-->

    <script src="lib/jquery/jquery-2.1.4.min.js"></script>

    <script src="lib/iScroll/iscroll.js"></script>
    <!--Concierge help -->
    <!--<script src='http://websdk.live.gotoassist.com/concierge.js'></script>-->
    <!-- IF using Sass (run gulp sass first), then uncomment below and remove the CSS includes above
    <link href="css/ionic.app.css" rel="stylesheet">
    -->

    <script type="text/javascript">
        var myScroll;
        function loadScroll() {
            setTimeout(function () {
                //debugger;
                //alert('scroll');
                myScroll = new iScroll('wrapper',
                { zoom: true, zoomMax: 4 });
            }, 1000);
        }

        document.addEventListener('DOMContentLoaded', loadScroll, false);

        //function initConcierge() {
        //concierge.setApplicationKey('MTQyOTs1Nzg=-1d2nf8bvvrlxqnvd0g5vfq2jkcrkk1hsjkr571bfg7hpqmhhk0wxm5i8wi4y8j1o');
        // }

        function openSupportWindow() {
            if (window.plugins && window.plugins.Hipmob) {
                var hipmob_app_id = '62f5b89ea9424be79419e8935a4354be';
                var Hipmob = window.plugins.Hipmob;

                Hipmob.openHelpdeskSearch(hipmob_app_id, {
                    'title': 'Help',
                    'query': 'Android',
                    'user': '<hipmob user id>',
                    'name': 'Femi',
                    'email': 'femi@hipmob.com',
                    'context': 'shopping for shoes',
                    'location': 'At home'
                });
            } else {
                alert('Hipmob plugin not available/ready.');
            }
        }

        // function initInAppPurchases() {

        //}
    </script>
</head>
<body>

    <!--<body ng-app="app" animation="slide-left-right-ios7">-->
    <div ng-app="app">
        <!--<div class="splash">
            <img src="images/splash.png" />
        </div>-->
        <div>
            <div>
                <ion-side-menus enable-menu-with-back-views="true">

                    <!-- Center content -->
                    <ion-side-menu-content enable-menu-with-back-views="true" edge-drag-threshold="200">
                        <ion-nav-bar class="bar-light">

                        </ion-nav-bar>
                        <ion-nav-view class="main-content"></ion-nav-view>
                    </ion-side-menu-content>

                    <!-- Left menu -->
                    <ion-side-menu side="left" ng-controller="sideMenuCtrl">
                        <ng-include src="'templates/sideMenu.html'"></ng-include>
                    </ion-side-menu>

                </ion-side-menus>

                <!--
                <ion-nav-bar class="bar-stable">

                </ion-nav-bar>
                <ion-nav-view></ion-nav-view>
                -->

            </div>
        </div>

    </div>


    <script src="scripts/app.js"></script>

    <script src="scripts/services/localDocumentsService.js"></script>
    <script src="scripts/services/fileItService.js"></script>
    <script src="scripts/services/appUserService.js"></script>
    <script src="scripts/services/availableShareKeysService.js"></script>
    <script src="scripts/services/documentsService.js"></script>
    <script src="scripts/services/familyUserService.js"></script>
    <script src="scripts/services/familyUsersService.js"></script>
    <script src="scripts/services/scanDocumentService.js"></script>
    <script src="scripts/services/stateHelperService.js"></script>
    <script src="scripts/services/teamPlayerService.js"></script>
    <script src="scripts/services/viewDocumentService.js"></script>
    <script src="scripts/services/loadingService.js"></script>
    <script src="scripts/services/emailHelperService.js"></script>
    <script src="scripts/services/passwordHelperService.js"></script>
    <script src="scripts/services/dateHelperService.js"></script>
    <script src="scripts/services/alertService.js"></script>

    <script src="scripts/services.js"></script>

    <script src="scripts/controllers.js"></script>
    <script src="scripts/controllers/loginCtrl.js"></script>
    <script src="scripts/controllers/scanDocumentsCtrl.js"></script>
    <script src="scripts/controllers/viewYourDocumentsCtrl.js"></script>
    <script src="scripts/controllers/inviteAFriendCtrl.js"></script>
    <script src="scripts/controllers/mainCtrl.js"></script>
    <script src="scripts/controllers/mainCardsCtrl.js"></script>
    <script src="scripts/controllers/memberCardCtrl.js"></script>
    <script src="scripts/controllers/settingsCtrl.js"></script>
    <script src="scripts/controllers/forgotPasswordCtrl.js"></script>
    <script src="scripts/controllers/sharingKeyManagementCtrl.js"></script>
    <script src="scripts/controllers/editAccountLoginCtrl.js"></script>
    <script src="scripts/controllers/editAccountUserCtrl.js"></script>
    <script src="scripts/controllers/newAccountCtrl.js"></script>
    <script src="scripts/controllers/addFamilyMembersCtrl.js"></script>
    <script src="scripts/controllers/teamCtrl.js"></script>
    <script src="scripts/controllers/aboutCtrl.js"></script>
    <script src="scripts/controllers/sideMenuCtrl.js"></script>
    <script src="scripts/controllers/emergencyShareCtrl.js"></script>
    <script src="scripts/controllers/documentTypeCtrl.js"></script>
    <script src="scripts/routes.js"></script>

    <script src="scripts/directives.js"></script>
    <script src="scripts/fileHelper.js"></script>
    <script src="scripts/dbHelper.js"></script>



    <script type="text/javascript">
        app.initialize();
        loadScroll();
        //loadAdMob();

        //initConcierge();
        //initInAppPurchases();

        window.onerror = function (err) {
            alert(err);
        };

        dbHelper.init();

        shareKeySKU = 'Myfileitsharekeyannual1';
        shareKeyBaseSKU = 'Myfilepeuserkey';//'Myfileitsharekeyuser';

        IAP = {
            //list: [shareKeySKU]
            list: []
        };

        for (var i = 1; i < 10; i++) {
            IAP.list.push(shareKeyBaseSKU + i);
        }

        IAP.load = function () {
            // Check availability of the storekit plugin
            if (!window.storekit) {
                //alert("In-App Purchases not available");
                return;
            }

            // Initialize
            storekit.init({
                debug: true, // Enable IAP messages on the console
                ready: IAP.onReady,
                purchase: function (transactionId, productId, receipt) {
                    if (IAP.purchaseCallback) {
                        IAP.purchaseCallback(productId);
                        delete IAP.purchaseCallback;
                    }
                },
                restore: IAP.onRestore,
                error: IAP.onError
            });

            IAP.onReady = function () {
                storekit.load(IAP.list, function (products, invalidIds) {
                    IAP.products = products;
                    IAP.loaded = true;
                    for (var i = 0; i < invalidIds.length; ++i) {
                        alert("Error: could not load " + invalidIds[i]);
                    }
                });
            };

            /*IAP.onPurchase = function (transactionId, productId, receipt) {
                //alert('onpurchase' + productId);
                //if (productId === shareKeySKU) {
                // alert(IAP.puchaseCallback);
                if (IAP.purchaseCallback) {
                    IAP.purchaseCallback(productId);
                    delete IAP.purchaseCallback;
                }
                //loadShareKey(transactionId, productId, receipt);
                // }
            };*/

            IAP.onRestore = function (transactionId, productId, transactionReceipt) {
                // alert('onRestore');
                if (productId == shareKeySKU) {
                    //Code to remove ads for the user
                    loadShareKey(transactionId, productId, receipt);
                }
            };

            IAP.onError = function (errorCode, errorMessage) {
                //alert(errorCode);
                //alert(errorMessage);
                //window.onerror(errorCode + errorMessage);
            };

            IAP.buy = function (productId) {
                storekit.purchase(productId);
            };

            IAP.restore = function () {
                storekit.restore();
            };

            IAP.onReady();      
        };

        function loadShareKey(transactionId, productId, receipt) {
            //sharekey resides on db service when user logs in
            //alert(transactionId);
            // alert(productId);
            //alert(receipt);
        }

        var adMobAttempts = 0;

        function loadAdMob() {
            adMobAttempts++;
            if (typeof admob != 'undefined') {
                var debug = true;

                var options = {
                    publisherId: "ca-app-pub-9515441170983746/7740403317",//"ca-app-pub-9515441170983746/3162777713 ",
                    autoShowBanner: true,
                    bannerAtTop: true
                };

                //admob.setOptions({
                //    publisherId: "ca-app-pub-9515441170983746/3162777713" //"ca-app-pub-XXXXXXXXXXXXXXXX/BBBBBBBBBB",  // Required
                //    // interstitialAdId: "ca-app-pub-XXXXXXXXXXXXXXXX/IIIIIIIIII",  // Optional
                //    //tappxIdiOs: "/XXXXXXXXX/Pub-XXXX-iOS-IIII",            // Optional
                //    // tappxIdAndroid: "/XXXXXXXXX/Pub-XXXX-Android-AAAA",        // Optional
                //    //tappxShare: 0.5                                        // Optional
                //});

                document.addEventListener(admob.events.onAdLoaded, function (e) {
                    //if (debug) { alert('Ad loaded' + e); }
                });

                document.addEventListener(admob.events.onAdFailedToLoad, function (e, c, r) {
                    if (debug) { alert('Ad FAILED LOAD=' + JSON.stringify(e) + c + r); }
                    if (adMobAttempts < 10) {
                        setTimeout(loadAdMob, 500);
                    }
                });

                // Start showing banners (atomatic when autoShowBanner is set to true)
                admob.createBannerView(
                    options,
					function (a, b, c) {
					    //if (debug) { alert(a + b + c); }
					},
                    function (a, b, c) {
                        if (debug) { alert('failed to create banner view' + a + b + c); }
                      
                    }
					)
            } 
        }


    </script>
</body>
</html>